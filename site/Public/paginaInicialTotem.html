<!DOCTYPE html>
<html lang="en">
  <staticContent>
    <mimeMap fileExtension=".js" mimeType="text/javascript" />
  </staticContent>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/headerTeste.css"">
      <!-- Linkando O  CSS da tela de dashboard (grafico)-->      
      <!-- linkando os icones-->
      <link rel=" stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
  <link rel="stylesheet" href="./css/PaginaInicial.css">
  <!-- linkando os icones-->
  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <title>Document</title>
</head>

<body>
  <!-- Header lateral -->
  <div id="header" class="header">
  </div>

  <!-- Header Superior -->
  <div class="headerTopzaum" id="headerTopzinho">
  </div>
  <!--Graficos-->
  <section>
    <div class="body" id="cardContainer">
      <!-- Div que engloba todas as divs -->
      <div class="container"> <!-- Div que tem o conteudo em si -->
        <div class="conteudo">

          <!-- Div que tem todo o quadrado ou cada card (ou cada post-it) -->
          <div class="card">

            <!-- Counteudo que tem em cada card (ou post-it)-->
            <div class="conteudo-card">

              <!-- Div que contem a imagem (aquela bola)-->
              <div class="imagem">

                <!-- imagem que vai ficar no quadrado do card-->
                <img src="./assets/img/totemVermelho (1).png">

              </div>

              <!-- Div que contem o nome do armazem -->
              <div class="nome-do-armazem-e-sua-descrisao">
                <span class="nome-do-armazem">Totem Nº1</span>
                <span class="descrisao-do-armazem">TOT001</span>
              </div>

              <!-- Div que contem o status do armazem -->
              <div class="status-armazem1">
                <span class="">Problema</span>
              </div>

              <!-- Div que tem o botão -->
              <div class="botao">
                <a href="./telaDoGraficoTecnico.html"> <button> Visualizar Totem  </button></a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--Dei varios crlt c e clrt v -->
      <!--***********************************************************************************************************-->

      <!-- Div que engloba todas as divs -->
      <div class="container">

        <!-- Div que tem o conteudo em si -->
        <div class="conteudo">

          <!-- Div que tem todo o quadrado ou cada card (ou cada post-it) -->
          <div class="card">

            <!-- Counteudo que tem em cada card (ou post-it)-->
            <div class="conteudo-card">

              <!-- Div que contem a imagem (aquela bola)-->
              <div class="imagem">

                <!-- imagem que vai ficar no quadrado do card-->
                <img src="./assets/img/totemAmarelo.png">

              </div>

              <!-- Div que contem os icones-->


              <!-- Div que contem o nome do armazem -->
              <div class="nome-do-armazem-e-sua-descrisao">
                <span class="nome-do-armazem">Totem Nº2</span>
                <span class="descrisao-do-armazem">TOT002</span>
              </div>

              <!-- Div que contem o status do armazem -->
              <div class="status-armazem2">
                <span>Atenção
                </span>
              </div>

              <!-- Div que tem o botão -->
              <div class="botao"><a href="./telaDoGraficoTecnico.html">
                  <button> Visualizar Totem</button>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!--Dei varios crlt c e clrt v -->
      <!--***********************************************************************************************************-->
      <!-- Div que engloba todas as divs -->
      <div class="container">

        <!-- Div que tem o conteudo em si -->
        <div class="conteudo">

          <!-- Div que tem todo o quadrado ou cada card (ou cada post-it) -->
          <div class="card">

            <!-- Counteudo que tem em cada card (ou post-it)-->
            <div class="conteudo-card">

              <!-- Div que contem a imagem (aquela bola)-->
              <div class="imagem">

                <!-- imagem que vai ficar no quadrado do card-->
                <img src="./assets/img/totemVerde.png">

              </div>

              <!-- Div que contem os icones-->

              <!-- Div que contem o nome do armazem -->
              <div class="nome-do-armazem-e-sua-descrisao">
                <span class="nome-do-armazem">Totem Nº3</span>
                <span class="descrisao-do-armazem">TOT003</span>
              </div>

              <!-- Div que contem o status do armazem -->
              <div class="status-armazem">
                <span>Ok</span>
              </div>

              <!-- Div que tem o botão -->
              <div class="botao"><a href="./telaDoGraficoTecnico.html">
                  <button > Visualizar Totem</button>
                </a>
              </div>
            </div>
          </div>
        </div>

        <!--***********************************************************************************************************-->

      </div>
    </div>
  </section>
</body>

</html>

<script src="./js/headerOficial.js">
</script>
<script>
  var cnpj = sessionStorage.FILIAL;
  let id = cnpj;
  id = id.replace(/\.|\-|\//g, '');

  function listar() {

    fetch(`/usuarios/listarTodosTotems/${id}`).then(function (resposta) {
      if (resposta.ok) {
        if (resposta.status == 204) {
          throw "Nenhum resultado encontrado!!";
        }

        resposta.json().then(function (resposta) {
          console.log("Dados recebidos: ", JSON.stringify(resposta));
          cardContainer.innerHTML = "";
          for (let i = 0; i < resposta.length; i++) {
            var publicacao = resposta[i];
           
            if (publicacao.status == "problema") {
              cardContainer.innerHTML += `
                      <div class="container"> <!-- Div que tem o conteudo em si -->
        <div class="conteudo">

          <!-- Div que tem todo o quadrado ou cada card (ou cada post-it) -->
          <div class="card">

            <!-- Counteudo que tem em cada card (ou post-it)-->
            <div class="conteudo-card">

              <!-- Div que contem a imagem (aquela bola)-->
              <div class="imagem">

                <!-- imagem que vai ficar no quadrado do card-->
                <img src="./assets/img/totemVermelho.png>

              </div>

              <!-- Div que contem o nome do armazem -->
              <div class="nome-do-armazem-e-sua-descrisao">
                <span class="nome-do-armazem">Totem ${publicacao.NumIdenti}</span>
              </div>

              <!-- Div que contem o status do armazem -->
              <div class="status-armazem1">
                <span class="">Problema</span>
              </div>

              <!-- Div que tem o botão -->
              <div class="botao">
                <a href="#"> 
                  <button onclick="verificar('${publicacao.NumIdenti}')"> Visualizar Supermercado </button>
                  </a>
              </div>
            </div>
          </div>
        </div>
      </div>
                      
                      `
            } else if (publicacao.status == "atencao") {
              cardContainer.innerHTML += `
                      <div class="container"> <!-- Div que tem o conteudo em si -->
        <div class="conteudo">

          <!-- Div que tem todo o quadrado ou cada card (ou cada post-it) -->
          <div class="card">

            <!-- Counteudo que tem em cada card (ou post-it)-->
            <div class="conteudo-card">

              <!-- Div que contem a imagem (aquela bola)-->
              <div class="imagem">

                <!-- imagem que vai ficar no quadrado do card-->
                <img src="./assets/img/totemAmarelo.png">

              </div>

              <!-- Div que contem o nome do armazem -->
              <div class="nome-do-armazem-e-sua-descrisao">
                <span class="nome-do-armazem">Totem ${publicacao.NumIdenti}</span>
              </div>

              <!-- Div que contem o status do armazem -->
              <div class="status-armazem2">
                <span class="">Atenção</span>
              </div>

              <!-- Div que tem o botão -->
              <div class="botao">
                <a href="#"> <button onclick="verificar('${publicacao.NumIdenti}')"> Visualizar Supermercado </button></a>
              </div>
            </div>
          </div>
        </div>
      </div>
                      
                      `
            } else {
              cardContainer.innerHTML += `
                      <div class="container"> <!-- Div que tem o conteudo em si -->
        <div class="conteudo">

          <!-- Div que tem todo o quadrado ou cada card (ou cada post-it) -->
          <div class="card">

            <!-- Counteudo que tem em cada card (ou post-it)-->
            <div class="conteudo-card">

              <!-- Div que contem a imagem (aquela bola)-->
              <div class="imagem">

                <!-- imagem que vai ficar no quadrado do card-->
                <img src="./assets/img/totemVerde.png">

              </div>

              <!-- Div que contem o nome do armazem -->
              <div class="nome-do-armazem-e-sua-descrisao">
                <span class="nome-do-armazem">Totem ${publicacao.NumIdenti}</span>
              </div>

              <!-- Div que contem o status do armazem -->
              <div class="status-armazem">
                <span class="">Ok</span>
              </div>

              <!-- Div que tem o botão -->
              <div class="botao">
                <a href="#"> <button onclick="verificar('${publicacao.NumIdenti}')"> Visualizar Supermercado </button></a>
              </div>
            </div>
          </div>
        </div>
      </div>
                      
                      `
            }
          
          
          }

        });
      } else {
        throw ('Houve um erro na API!');
      }
    }).catch(function (resposta) {
      console.error(resposta);
    });
  }


  listar();


  function verificar(identificacaoTotem) {
    sessionStorage.NUMERODEINDENTIFICACAO = identificacaoTotem;
    window.location = "./telaDoGraficoTecnico.html"
  }

</script>